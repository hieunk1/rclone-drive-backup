name: Upload to Google Drive

on:
  workflow_dispatch:

jobs:
  upload:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Install rclone
      run: |
        curl https://rclone.org/install.sh | sudo bash

    - name: Create rclone config
      run: |
        mkdir -p ~/.config/rclone
        echo "[gdrive_sa]" > ~/.config/rclone/rclone.conf
        echo "type = drive" >> ~/.config/rclone/rclone.conf
        echo "scope = drive" >> ~/.config/rclone/rclone.conf
        echo "service_account_file = /home/runner/sa.json" >> ~/.config/rclone/rclone.conf

        # Táº¡o file JSON cho SA
        echo "${{ secrets.GDRIVE_SA_JSON }}" > /home/runner/sa.json

    - name: Test connection
      run: |
        rclone ls gdrive_sa: || { cat ~/.config/rclone/rclone.conf; exit 1; }

    - name: Upload to Google Drive
      run: |
